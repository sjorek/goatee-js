<!DOCTYPE html><html lang="en"><head><title>Dom/Traversal/Level2NodeIterator</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../../"><meta name="groc-document-path" content="Dom/Traversal/Level2NodeIterator"><meta name="groc-project-path" content="src/Dom/Traversal/Level2NodeIterator.coffee"><link rel="stylesheet" type="text/css" media="all" href="../../assets/style.css"><script type="text/javascript" src="../../assets/behavior.js"></script><body><div id="meta"><div class="file-path">src/Dom/Traversal/Level2NodeIterator.coffee</div></div><div id="document"><div class="segment"><div class="comments "><div class="wrapper"><p>© Copyright 2013 Stephan Jorek <a href="&#109;&#97;&#105;l&#x74;&#111;:&#115;&#116;e&#x70;&#104;&#x61;n&#46;&#x6a;&#111;&#x72;&#x65;&#107;&#64;&#103;&#109;&#x61;&#105;&#108;&#46;&#99;&#111;&#109;">&#115;&#116;e&#x70;&#104;&#x61;n&#46;&#x6a;&#111;&#x72;&#x65;&#107;&#64;&#103;&#109;&#x61;&#105;&#108;&#46;&#99;&#111;&#109;</a>  </p>

<p>Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at</p>

<p><a href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></p>

<p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
implied. See the License for the specific language governing
permissions and limitations under the License.</p></div></div></div><div class="segment"><div class="code folded"><div class="marker wrapper"><span class="c1"># require</span></div><div class="wrapper"><span class="p">{</span><span class="nx">Node</span><span class="o">:</span><span class="p">{</span>
  <span class="nx">DOCUMENT_NODE</span>
<span class="p">}}</span>              <span class="o">=</span> <span class="nx">require</span> <span class="s">&#39;../Node&#39;</span>

<span class="p">{</span><span class="nx">Document</span><span class="o">:</span><span class="p">{</span>
  <span class="nx">ownerDocument</span>
<span class="p">}}</span>              <span class="o">=</span> <span class="nx">require</span> <span class="s">&#39;../Document&#39;</span>

<span class="p">{</span><span class="nx">Traversal</span><span class="p">}</span>     <span class="o">=</span> <span class="nx">require</span> <span class="s">&#39;../Traversal&#39;</span></div></div></div><div class="segment"><div class="code folded"><div class="marker wrapper"><span class="c1"># export</span></div><div class="wrapper"><span class="nv">exports = </span><span class="nx">module</span><span class="o">?</span><span class="p">.</span><span class="nx">exports</span> <span class="o">?</span> <span class="k">this</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><h1 id="level2nodeiterator">Level2NodeIterator</h1></div></div></div><div class="segment"><div class="comments doc-section doc-section-public"><div class="wrapper"><p><span class='doc-section-header'>Public class <em>Level2NodeIterator</em> extends <em>goatee.Dom.Traversal</em> and is in namespace <em>goatee.Dom.Traversal</em></span></p>

<hr />

<p>A class to hold state for a DOM traversal.
This implementation depends on <em>DOM Level ≥ 2</em>'s <code>NodeIterator</code>.</p>

<p>Reference:</p>

<ul>
<li><a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/traversal.html#Traversal-NodeIterator">DOM Level 2 <code>NodeIterator</code> Interface-Specification</a></li>
</ul></div></div><div class="code"><div class="wrapper"><span class="nv">exports.Level2NodeIterator = </span><span class="o">\</span>
<span class="k">class</span> <span class="nx">Level2NodeIterator</span> <span class="k">extends</span> <span class="nx">Traversal</span></div></div></div><div class="segment"><div class="comments doc-section doc-section-public"><div class="wrapper"><p><span class='doc-section-header'>Public property <em>filter</em> is a <em>Number</em></span></p>

<hr />

<blockquote>
  <p>Bitwise OR'd list of Filter specification constants from the NodeFilter
    DOM interface, indicating which nodes to iterate over.</p>
</blockquote>

<p>References:</p>

<ul>
<li><p><a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/traversal.html#Traversal-NodeFilter">DOM Level 2 <code>NodeFilter</code> Interface-Specification</a></p></li>
<li><p><a href="https://developer.mozilla.org/en/DOM/NodeFilter#Filter_specification_constants"><code>NodeFilter</code> Constants</a></p></li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="nv">filter: </span><span class="nx">NodeFilter</span><span class="p">.</span><span class="nx">SHOW_ELEMENT</span></div></div></div><div class="segment"><div class="comments doc-section doc-section-public"><div class="wrapper"><p><span class='doc-section-header'>Public property <em>options</em> is an <em>Object</em></span></p>

<hr />

<blockquote>
  <p>An object implementing the NodeFilter interface; its <code>acceptNode()</code> method
    will be called for each node in the subtree based at root which is accepted
    as included by the <code>filter</code> flag (above) to determine whether or not to
    include it in the list of iterable nodes (a simple callback function may
    also be used instead).  The method should return one of
    <code>NodeFilter.[FILTER_ACCEPT|FILTER_REJECT|FILTER_SKIP]</code>, ie.:</p>

<pre><code>{
  acceptNode: function (node) {
    return NodeFilter.FILTER_ACCEPT;
  }
}
</code></pre>
</blockquote>

<p>References:</p>

<ul>
<li><p><a href="http://www.w3.org/TR/DOM-Level-2-Traversal-Range/traversal.html#Traversal-NodeFilter">DOM Level 2 <code>NodeFilter</code> Interface-Specification</a></p></li>
<li><p><a href="https://developer.mozilla.org/en-US/docs/DOM/NodeFilter"><code>NodeFilter</code> Documentation</a></p></li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="nv">options: </span><span class="kc">null</span></div></div></div><div class="segment"><div class="comments doc-section doc-section-public"><div class="wrapper"><p><span class='doc-section-header'>Public method <em>run</em></span></p>

<hr />

<p>Processes the DOM tree in breadth-first order.</p>

<p>Parameters:</p>

<ul>
<li><strong><em>root</em> must be a <em>Node</em>.</strong><br/>(The root node of the traversal)</li>
</ul>

<p><strong>Returns a <em>goatee.Dom.Traversal</em></strong></p></div></div><div class="code"><div class="wrapper">  <span class="nv">run: </span><span class="nf">(root) -&gt;</span>
    <span class="nx">@process</span> <span class="nx">root</span><span class="p">,</span> <span class="nx">@prepare</span> <span class="nx">root</span></div></div></div><div class="segment"><div class="comments doc-section doc-section-public"><div class="wrapper"><p><span class='doc-section-header'>Public method <em>prepare</em></span></p>

<hr />

<p>Prepare the node iterator for a single root node.</p>

<p>Parameters:</p>

<ul>
<li><strong><em>root</em> must be a <em>Node</em>.</strong><br/>(The root node of the traversal)</li>
</ul>

<p><strong>Returns a <em>NodeIterator</em></strong></p></div></div><div class="code"><div class="wrapper">  <span class="nv">prepare: </span><span class="nf">(root) -&gt;</span>
    <span class="nx">@collect</span> <span class="nx">root</span><span class="p">,</span> <span class="nx">ownerDocument</span><span class="p">(</span><span class="nx">root</span><span class="p">)</span></div></div></div><div class="segment"><div class="comments doc-section doc-section-public"><div class="wrapper"><p><span class='doc-section-header'>Public method <em>collect</em></span></p>

<hr />

<p>Create an iterator collecting a single node's immediate child-nodes.</p>

<p>Parameters:</p>

<ul>
<li><p><strong><em>root</em> must be a <em>Node</em>.</strong><br/>(The root node of the traversal.)</p></li>
<li><p><strong><em>doc</em> must be a <em>Document</em>.</strong><br/>(Root's owner-document.)</p></li>
</ul>

<p><strong>Returns a <em>NodeIterator</em></strong></p>

<p>Reference:</p>

<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Document.createNodeIterator"><code>createNodeIterator</code> Documentation</a></li>
</ul></div></div><div class="code"><div class="wrapper">  <span class="nv">collect: </span><span class="nf">(root, doc) -&gt;</span>
    <span class="nx">doc</span><span class="p">.</span><span class="nx">createNodeIterator</span><span class="p">(</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Node to use as root</p></div></div><div class="code"><div class="wrapper">      <span class="nx">root</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Only consider nodes that match this filter</p></div></div><div class="code"><div class="wrapper">      <span class="nx">@filter</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>Object containing the function to use as method of the NodeFilter</p></div></div><div class="code"><div class="wrapper">      <span class="nx">@options</span><span class="p">,</span></div></div></div><div class="segment"><div class="comments doc-section doc-section-deprecated"><div class="wrapper"><p><span class='doc-section-header'>Deprecated</span></p>

<blockquote>
  <p>Note: Prior to Gecko 12.0 (Firefox 12.0 / Thunderbird 12.0 /
    SeaMonkey 2.9), this method accepted an optional fourth parameter
    (entityReferenceExpansion) that is not part of the DOM4 specification,
    and has therefore been removed.  This parameter indicated whether or
    not the children of entity reference nodes were visible to the
    iterator.  Since such nodes were never created in browsers, this
    parameter had no effect.</p>
</blockquote></div></div><div class="code"><div class="wrapper">      <span class="kc">false</span>
    <span class="p">)</span></div></div></div><div class="segment"><div class="comments doc-section doc-section-public"><div class="wrapper"><p><span class='doc-section-header'>Public method <em>process</em></span></p>

<hr />

<p>Processes the root node and all of its children.</p>

<p>Parameters:</p>

<ul>
<li><p><strong><em>root</em> must be a <em>Node</em>.</strong><br/>(The root node of the traversal.)</p></li>
<li><p><strong><em>node</em> must be a <em>NodeIterator</em>.</strong><br/>(The current node of the traversal.)</p></li>
</ul>

<p><strong>Returns a <em>goatee.Dom.Traversal</em></strong></p></div></div><div class="code"><div class="wrapper">  <span class="nv">process: </span><span class="nf">(root, iterator) -&gt;</span></div></div></div><div class="segment"><div class="comments "><div class="wrapper"><p>We deliberately enforce equality instead of identity here.</p></div></div><div class="code"><div class="wrapper">    <span class="nx">@callback</span> <span class="nx">root</span> <span class="k">if</span> <span class="o">`</span><span class="nx">root</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">==</span> <span class="nx">DOCUMENT_NODE</span><span class="o">`</span>
    <span class="nx">@callback</span> <span class="nx">node</span> <span class="k">while</span> <span class="nv">node = </span><span class="nx">iterator</span><span class="p">.</span><span class="nx">nextNode</span><span class="p">()</span>
    <span class="k">return</span> <span class="k">this</span></div></div></div><div class="segment"><div class="comments doc-section doc-section-static doc-section-public"><div class="wrapper"><p><span class='doc-section-header'>Static public method <em>create</em></span></p>

<hr />

<p>Creates the <code>Traversal</code>-instance.</p>

<p>Parameters:</p>

<ul>
<li><strong><em>callback</em> must be a <em>Function</em>.</strong><br/>(A function, called for each traversed node)</li>
</ul>

<p><strong>Returns a <em>goatee.Dom.Traversal</em></strong></p></div></div><div class="code"><div class="wrapper">  <span class="vi">@create: </span><span class="nf">(callback) -&gt;</span>
    <span class="k">new</span> <span class="nx">Level2NodeIterator</span> <span class="nx">callback</span></div></div></div></div></body></html>